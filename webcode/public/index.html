<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <!-- ป้องกัน pinch-zoom / double-tap zoom บนมือถือ -->
    <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,minimum-scale=1,user-scalable=0,viewport-fit=cover" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="default" />

    <title>Web Terminal — iSH-like sizing (no-zoom)</title>

    <link rel="manifest" href="/manifest.json" />
    <link rel="apple-touch-icon" href="/icons/apple-touch-icon.png" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/xterm/css/xterm.css" />

    <style>
      /* Prevent iOS text auto-zoom and keep consistent sizing */
      html, body {
        height: 100%;
        margin: 0;
        background: #0b0f14;
        color: #fff;
        font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
        -webkit-text-size-adjust: 100%; /* don't auto adjust text size */
        touch-action: manipulation;
        -webkit-touch-callout: none;
        -webkit-user-select: none;
      }

      .toolbar {
        display: flex;
        gap: 8px;
        padding: 8px;
        background: #071722;
        align-items: center;
        justify-content: space-between;
        user-select: none;
        -webkit-user-select: none;
      }
      .left, .right { display:flex; gap:8px; align-items:center; }
      .btn {
        padding: 10px 12px;
        border-radius: 8px;
        background: #0f1720;
        color: #fff;
        border: 1px solid #23303a;
        font-weight: 600;
        -webkit-tap-highlight-color: rgba(0,0,0,0.15);
        touch-action: manipulation;
      }
      .modifier { min-width: 64px; }
      .active { background: linear-gradient(180deg,#1f6a9b,#164d74); }

      /* Terminal area: avoid overflow and prevent pinch/double-tap zoom here */
      #term {
        height: calc(100vh - 64px);
        min-height: 120px;
        overflow: hidden;
        /* Prevent pinch/zoom on the terminal area */
        touch-action: none;
        -webkit-user-select: none;
        -webkit-touch-callout: none;
      }

      /* Hidden input must have font-size >= 16px to avoid iOS auto-zoom */
      #hidden-input {
        position: absolute;
        left: 12px; /* keep it in viewport to avoid some browsers' quirks */
        top: -9999px; /* visually offscreen but still focusable; font-size must be >=16px */
        opacity: 0;
        width: 1px;
        height: 1px;
        font-size: 16px !important;
        -webkit-text-size-adjust: 100%;
      }

      .install-hint { font-size: 12px; color: #9fb9c9; padding: 6px 10px; }

    </style>
  </head>

  <body>
    <div class="toolbar" role="toolbar" aria-label="special keys toolbar">
      <div class="left">
        <button id="btn-ctrl" class="btn modifier" data-mod="ctrl">Ctrl</button>
        <button id="btn-alt"  class="btn modifier" data-mod="alt">Alt</button>

        <button id="btn-esc"  class="btn" data-send="esc">Esc</button>
        <button id="btn-tab"  class="btn" data-send="tab">Tab</button>

        <div style="width:1px;height:32px;background:#1b2a30;margin:0 8px;"></div>

        <button id="btn-left" class="btn" data-arrow="left">←</button>
        <button id="btn-up"   class="btn" data-arrow="up">↑</button>
        <button id="btn-down" class="btn" data-arrow="down">↓</button>
        <button id="btn-right"class="btn" data-arrow="right">→</button>
      </div>

      <div class="right">
        <button id="btn-keyboard" class="btn">Keyboard</button>
        <button id="btn-paste" class="btn">Paste</button>
        <button id="btn-install" class="btn" style="display:none">Install</button>
      </div>
    </div>

    <div id="term" role="application" aria-label="terminal"></div>

    <input id="hidden-input" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" />

    <div class="install-hint" id="install-hint">
      ติดตั้ง: เปิดเมนู Share → Add to Home Screen (iOS) หรือกด Install (Android)
    </div>

    <script src="https://cdn.jsdelivr.net/npm/xterm/lib/xterm.js"></script>
    <script src="app.js"></script>
    <script>
      if ('serviceWorker' in navigator) {
        navigator.serviceWorker.register('/sw.js').catch(()=>{});
      }
    </script>
  </body>
</html>